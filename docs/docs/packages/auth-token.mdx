---
title: Auth Token
tags:
  - cli
---

![npm (scoped)](https://img.shields.io/npm/v/@spotifly/auth-token)

A simple and lightweight implementation of Spotify's Authorization Code Flow according to the [Spotify docs](https://developer.spotify.com/documentation/general/guides/authorization/code-flow/).

- CLI and programmatic use
- Customizable

This helper was mainly developed to simplify my [Spotify history scrobbler](https://github.com/eegli/spotify-history).

## CLI Usage

Create your custom command using the query builder below and paste it into your terminal.

import { CliCodeBlock } from '@site/src/components/code-blocks/codeblock';

<CliCodeBlock
  cli="spotifly auth-token"
  npx="npx @spotifly/auth-token@latest"
  commandMap={{
    clientId: 'id',
    clientSecret: 'secret',
    port: 3000,
    scopes: 'user-read-email',
    fileName: 'spotify-token',
    outDir: '',
  }}
  required={['clientId', 'clientSecret']}
/>

### Options

| Flag                      | **_(required?)_** Description                                                                                 |
| ------------------------- | ------------------------------------------------------------------------------------------------------------- |
| `-ci` \| `--clientId`     | ✅ The client id of your Spotify application                                                                  |
| `-cs` \| `--clientSecret` | ✅ The client secret of your Spotify application                                                              |
| `-p` \| `--port`          | ❌ Port for the localhost redirect URL. Default: `3000`                                                       |
| `-s` \| `--scopes`        | ❌ Spotify authentication scopes. Multiple scopes need to be separated by a space. Default: "user-read-email" |
| `-o` \| `--outDir`        | ❌ Custom relative output directory. Default: Current directory                                               |
| `-f` \| `--fileName`      | ❌ Custom name for the output JSON file. Default: "spotify-token"                                             |

## Programmatic

### Installation

```bash
yarn add -D spotify-auth-token
```

or

```bash
npm install spotify-auth-token --save-dev
```

### Options

The options and defaults are the same as for the CLI plus `noEmit`. If
`noEmit` is set to `true`, the token will not be saved to the file
system.

```ts
type Options = {
  clientId: string;
  clientSecret: string;
  port?: number;
  scopes?: string;
  fileName?: string;
  outDir?: string;
  noEmit?: boolean;
};
```

### Examples

- CommonJS

```js
const { authorize } = require('spotify-auth-token/dist/authorize');

const token = await authorize({
  clientId: 'clientId',
  clientSecret: 'clientSecret',
  port: 3000,
  scopes: 'user-read-email user-top-read',
  noEmit: true,
});
```

- ES Modules

```js
import authorize from 'spotify-auth-token';

const token = await authorize({
  clientId: 'clientId',
  clientSecret: 'clientSecret',
  port: 3000,
  scopes: 'user-read-email user-top-read',
});
```

- TypeScript

```ts
import authorize, { UserConfig } from 'spotify-auth-token';

const config: UserConfig = {
  clientId: 'clientId',
  clientSecret: 'clientSecret',
  port: 3000,
  scopes: 'user-read-email user-top-read',
};

const token = await authorize(config);
```
