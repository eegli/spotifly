"use strict";(self.webpackChunk_spotifly_website=self.webpackChunk_spotifly_website||[]).push([[683],{7829:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>d,toc:()=>h});var r=n(4246),a=n(1670),i=n(3930),s=n(9798),l=n(5705);const o={title:"Auth Token",tags:["cli"]},c=void 0,d={id:"packages/auth-token",title:"Auth Token",description:"npm Codecov",source:"@site/docs/packages/auth-token.mdx",sourceDirName:"packages",slug:"/packages/auth-token",permalink:"/docs/packages/auth-token",draft:!1,unlisted:!1,editUrl:"https://github.com/eegli/spotifly/tree/main/website/docs/packages/auth-token.mdx",tags:[{label:"cli",permalink:"/docs/tags/cli"}],version:"current",frontMatter:{title:"Auth Token",tags:["cli"]},sidebar:"tutorialSidebar",previous:{title:"Command Line",permalink:"/docs/command-line"},next:{title:"Core",permalink:"/docs/packages/core"}},u={},h=[{value:"Motivation",id:"motivation",level:2},{value:"CLI Usage",id:"cli-usage",level:2},{value:"Options",id:"options",level:3},{value:"Programmatic Usage",id:"programmatic-usage",level:2},{value:"Installation",id:"installation",level:3},{value:"Options",id:"options-1",level:3},{value:"Examples",id:"examples",level:3}];function p(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.img,{src:"https://img.shields.io/npm/v/@spotifly/auth-token",alt:"npm"})," ",(0,r.jsx)(t.img,{src:"https://codecov.io/gh/eegli/spotifly/branch/main/graph/badge.svg?flag=auth-token",alt:"Codecov"})]}),"\n",(0,r.jsx)(t.h2,{id:"motivation",children:"Motivation"}),"\n",(0,r.jsxs)(t.p,{children:["This package provides a simple and lightweight implementation of Spotify's Authorization Code Flow according to the ",(0,r.jsx)(t.a,{href:"https://developer.spotify.com/documentation/general/guides/authorization/code-flow/",children:"Spotify docs"}),". You authenticate with a Spotify application and get back a refresh token that can be used to access Spotify data in long-running applications. If you're not yet familiar with Spotify's authorization process, check out ",(0,r.jsx)(t.a,{href:"/docs/authorization",children:"this quick summary"})," or read ",(0,r.jsx)(t.a,{href:"https://developer.spotify.com/documentation/general/guides/authorization/",children:"the official docs"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"Usually, a refresh token only needs to be generated once. Such a token only expires when the client secret of your Spotify application is reset and otherwise lives forever."}),"\n",(0,r.jsxs)(t.p,{children:["This helper was mainly developed to simplify my ",(0,r.jsx)(t.a,{href:"https://github.com/eegli/spotify-history",children:"Spotify history scrobbler"}),"."]}),"\n",(0,r.jsx)(t.h2,{id:"cli-usage",children:"CLI Usage"}),"\n",(0,r.jsx)(t.p,{children:"Create your custom command using the query builder below and paste it into your terminal."}),"\n","\n","\n",(0,r.jsx)(l.q,{cli:"spotifly auth",npx:"npx @spotifly/cli@latest auth",args:{"client-id":"","client-secret":"",port:"3000",scopes:["user-read-email"],"file-name":"spotify-token","out-dir":""},flags:{"no-emit":!1},scopesKey:"scopes",required:["client-id","client-secret"]}),"\n",(0,r.jsx)(t.h3,{id:"options",children:"Options"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Flag"}),(0,r.jsxs)(t.th,{children:[(0,r.jsx)(t.em,{children:"(required?)"})," Description"]})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"--client-id"})," ",(0,r.jsx)(t.code,{children:"[string]"})]}),(0,r.jsx)(t.td,{children:"\u2705 The client id of your Spotify application"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"--client-secret"})," ",(0,r.jsx)(t.code,{children:"[string]"})]}),(0,r.jsx)(t.td,{children:"\u2705 The client secret of your Spotify application"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"-s"}),", ",(0,r.jsx)(t.code,{children:"--scopes"})," ",(0,r.jsx)(t.code,{children:"[string]"})]}),(0,r.jsx)(t.td,{children:'\u274c Spotify authorization scopes. Multiple scopes need to be separated by a space. Default: "user-read-email"'})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"-p"}),", ",(0,r.jsx)(t.code,{children:"--port"})," ",(0,r.jsx)(t.code,{children:"[number]"})]}),(0,r.jsxs)(t.td,{children:["\u274c Port for the localhost redirect URL. Default: ",(0,r.jsx)(t.code,{children:"3000"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"-o"}),", ",(0,r.jsx)(t.code,{children:"--out-dir"})," ",(0,r.jsx)(t.code,{children:"[string]"})]}),(0,r.jsx)(t.td,{children:"\u274c Custom relative output directory. Default: Current directory"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"-f"}),", ",(0,r.jsx)(t.code,{children:"--file-name"})," ",(0,r.jsx)(t.code,{children:"[string]"})]}),(0,r.jsx)(t.td,{children:'\u274c Custom name for the output JSON file. Default: "spotify-token"'})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"--no-emit"})," ",(0,r.jsx)(t.code,{children:"[boolean]"})]}),(0,r.jsxs)(t.td,{children:["\u274c When set to ",(0,r.jsx)(t.code,{children:"true"}),", does not save the token to the file system. Default: ",(0,r.jsx)(t.code,{children:"false"})]})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"programmatic-usage",children:"Programmatic Usage"}),"\n",(0,r.jsx)(t.h3,{id:"installation",children:"Installation"}),"\n",(0,r.jsxs)(i.Z,{groupId:"npm2yarn",children:[(0,r.jsx)(s.Z,{value:"npm",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm install -D @spotifly/auth-token\n"})})}),(0,r.jsx)(s.Z,{value:"yarn",label:"Yarn",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"yarn add --dev @spotifly/auth-token\n"})})}),(0,r.jsx)(s.Z,{value:"pnpm",label:"pnpm",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"pnpm add -D @spotifly/auth-token\n"})})})]}),"\n",(0,r.jsx)(t.h3,{id:"options-1",children:"Options"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"type Options = {\n  clientId: string;\n  clientSecret: string;\n  port?: number;\n  scopes?: string;\n  fileName?: string;\n  outDir?: string;\n  noEmit?: boolean;\n};\n"})}),"\n",(0,r.jsx)(t.h3,{id:"examples",children:"Examples"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"CommonJS"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"const { authorize } = require('@spotifly/auth-token');\n\nconst token = await authorize({\n  clientId: 'clientId',\n  clientSecret: 'clientSecret',\n  port: 3000,\n  scopes: 'user-read-email user-top-read',\n  noEmit: true,\n});\n"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"ES Modules"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"import { authorize } from '@spotifly/auth-token';\n\nconst token = await authorize({\n  clientId: 'clientId',\n  clientSecret: 'clientSecret',\n  port: 3000,\n  scopes: 'user-read-email user-top-read',\n});\n"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"TypeScript"}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"import { authorize, Options } from '@spotifly/auth-token';\n\nconst options: Options = {\n  clientId: 's',\n  clientSecret: 's',\n  noEmit: true,\n};\n\nconst token = await authorize(options);\n"})})]})}function m(e={}){const{wrapper:t}={...(0,a.a)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},9798:(e,t,n)=>{n.d(t,{Z:()=>s});n(7378);var r=n(624);const a={tabItem:"tabItem_wHwb"};var i=n(4246);function s(e){let{children:t,hidden:n,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.Z)(a.tabItem,s),hidden:n,children:t})}},3930:(e,t,n)=>{n.d(t,{Z:()=>k});var r=n(7378),a=n(624),i=n(3457),s=n(3620),l=n(9834),o=n(654),c=n(784),d=n(1819);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:a}}=e;return{value:t,label:n,attributes:r,default:a}}))}(n);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const a=(0,s.k6)(),i=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,o._X)(i),(0,r.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,i=h(e),[s,o]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:i}))),[c,u]=m({queryString:n,groupId:a}),[f,x]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,i]=(0,d.Nk)(n);return[a,(0,r.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:a}),g=(()=>{const e=c??f;return p({value:e,tabValues:i})?e:null})();(0,l.Z)((()=>{g&&o(g)}),[g]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),x(e)}),[u,x,i]),tabValues:i}}var x=n(6457);const g={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var j=n(4246);function b(e){let{className:t,block:n,selectedValue:r,selectValue:s,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{const t=e.currentTarget,n=o.indexOf(t),a=l[n].value;a!==r&&(c(t),s(a))},u=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=o.indexOf(e.currentTarget)+1;t=o[n]??o[0];break}case"ArrowLeft":{const n=o.indexOf(e.currentTarget)-1;t=o[n]??o[o.length-1];break}}t?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":n},t),children:l.map((e=>{let{value:t,label:n,attributes:i}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>o.push(e),onKeyDown:u,onClick:d,...i,className:(0,a.Z)("tabs__item",g.tabItem,i?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function y(e){let{lazy:t,children:n,selectedValue:a}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a})))})}function v(e){const t=f(e);return(0,j.jsxs)("div",{className:(0,a.Z)("tabs-container",g.tabList),children:[(0,j.jsx)(b,{...e,...t}),(0,j.jsx)(y,{...e,...t})]})}function k(e){const t=(0,x.Z)();return(0,j.jsx)(v,{...e,children:u(e.children)},String(t))}},5705:(e,t,n)=>{n.d(t,{q:()=>y});var r=n(2750),a=n(1758),i=n(4614),s=n(1230),l=n(483),o=n(1015),c=n(4669),d=n(5140),u=n(4591),h=n(7378),p=n(2806),m=n(5731),f=n(2536),x=n(4246);const g=e=>{let{children:t}=e;return(0,x.jsx)(f.Z,{language:"npx",children:t})},j=["token","profile"],b="auth method",y=e=>{let{cli:t,npx:n,args:f,flags:y,required:v=[],scopesKey:k,accessToken:w}=e;const[S,I]=h.useState({...f,...y}),[Z,C]=h.useState("token"),[q,T]=h.useState(""),V=null!=w,N=e=>v.includes(e),D={...S,[Z]:q};return(0,x.jsxs)(p.C,{children:[V?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(a.Z,{component:"form",sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"15px 10px","& > *":{width:"25ch"},mb:2},children:[(0,x.jsx)(u.Z,{sx:{width:"25ch"},variant:"outlined",value:Z,label:b,select:!0,required:!0,onChange:e=>{C(e.target.value),T("")},children:j.map((e=>(0,x.jsx)(c.Z,{value:e,children:e},e)))},b),(0,x.jsx)(u.Z,{type:"text",required:!0,label:Z,value:q,onChange:e=>T(e.target.value),variant:"outlined"},"auth input")]}),(0,x.jsxs)("p",{children:["Using this command requires authentication. If you have Spotifly configuration file, you can specify a profile to use instead of an access token. If you specify a profile, an access token will be used automatically for you. See"," ",(0,x.jsx)("a",{href:"/docs/command-line#configuration-and-auto-authentication",children:"the docs about access configuration"}),"."]}),(0,x.jsx)("hr",{})]}):null,(0,x.jsx)(a.Z,{component:"form",sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"15px 10px","& > *":{width:"25ch"},mb:2},children:Object.entries(S).map((e=>{let[t,n]=e;return"boolean"==typeof n?(0,x.jsx)(a.Z,{display:"flex",justifyContent:"center",children:(0,x.jsx)(l.Z,{label:t,control:(0,x.jsx)(i.Z,{checked:n,onChange:()=>I({...S,[t]:!n})},t)},t)},t):t===k?(0,x.jsxs)(s.Z,{required:N(t),children:[(0,x.jsx)(o.Z,{htmlFor:t,children:t}),(0,x.jsx)(d.Z,{multiple:!0,labelId:t,label:t,value:n,onChange:e=>I({...S,[t]:e.target.value}),children:m.g8.map((e=>(0,x.jsx)(c.Z,{value:e,children:e},e)))})]},t):Array.isArray(n)?(0,x.jsx)(u.Z,{variant:"outlined",value:n[0],label:t,select:!0,required:N(t),onChange:e=>{I({...S,[t]:(0,m.p1)(n,e.target.value)})},children:n.map((e=>(0,x.jsx)(c.Z,{value:e,children:e},e)))},t):(0,x.jsx)(u.Z,{type:"text",required:N(t),label:t,value:n,onChange:e=>I({...S,[t]:e.target.value}),variant:"outlined"},t)}))}),[["With NPX",n],["With CLI",t]].map((e=>{let[t,n]=e;return(0,x.jsxs)(h.Fragment,{children:[(0,x.jsx)(r.Z,{fontWeight:"bold",children:t}),(0,x.jsx)(g,{children:(0,m._F)({base:n,obj:D,multiValueKeys:[k]})})]},t)}))]})}},2806:(e,t,n)=>{n.d(t,{C:()=>d});var r=n(5421),a=n(2905),i=n(5970),s=n(7378),l=n(4246);const o=(0,a.Z)({palette:{mode:"dark",primary:{main:"#90caf9",light:"#b5dcfb",dark:"#6bb8f7"}}}),c=(0,a.Z)({palette:{mode:"light",primary:{main:"#4a44a2",light:"#514bb2",dark:"#433d92"}}}),d=e=>{let{children:t}=e;const{colorMode:n}=(0,r.I)(),a=(0,s.useMemo)((()=>"light"===n?c:o),[n]);return(0,l.jsx)(i.Z,{theme:a,children:t})}},5731:(e,t,n)=>{function r(e){let{base:t,obj:n,multiValueKeys:r=[]}=e;return t.trim()+" "+Object.entries(n).reduce(((e,t)=>{let[n,a]=t;if(!1===a||""===a)return e;if(e+=`--${n} `,!0===a)return e;if(Array.isArray(a)){return e+=(r.includes(n)?`"${a.join(" ")}"`:a[0])+" "}return a.indexOf(" ")>-1&&" "!==a.slice(-1)&&(a=`"${a}"`),e+a+" "}),"").trim()}function a(e,t){const n=e.indexOf(t);return n>-1&&([e[0],e[n]]=[e[n],e[0]]),e}n.d(t,{_F:()=>r,g8:()=>i,p1:()=>a});const i=["ugc-image-upload","user-read-playback-state","user-modify-playback-state","user-read-currently-playing","user-read-private","user-read-email","user-follow-modify","user-follow-read","user-library-modify","user-library-read","app-remote-control","user-read-playback-position","user-top-read","user-read-recently-played","playlist-modify-private","playlist-read-collaborative","playlist-read-private","playlist-modify-public"]}}]);