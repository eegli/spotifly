"use strict";(self.webpackChunk_spotifly_website=self.webpackChunk_spotifly_website||[]).push([[683],{7829:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>o,metadata:()=>u,toc:()=>p});var n=a(4246),r=a(1670),l=a(3930),i=a(9798),s=a(5705);const o={title:"Auth Token",tags:["cli"]},c=void 0,u={id:"packages/auth-token",title:"Auth Token",description:"npm Codecov",source:"@site/docs/packages/auth-token.mdx",sourceDirName:"packages",slug:"/packages/auth-token",permalink:"/docs/packages/auth-token",draft:!1,unlisted:!1,editUrl:"https://github.com/eegli/spotifly/tree/main/website/docs/packages/auth-token.mdx",tags:[{label:"cli",permalink:"/docs/tags/cli"}],version:"current",frontMatter:{title:"Auth Token",tags:["cli"]},sidebar:"tutorialSidebar",previous:{title:"Command Line",permalink:"/docs/command-line"},next:{title:"Core",permalink:"/docs/packages/core"}},d={},p=[{value:"Motivation",id:"motivation",level:2},{value:"CLI Usage",id:"cli-usage",level:2},{value:"Flags and Commands",id:"flags-and-commands",level:3},{value:"Programmatic Usage",id:"programmatic-usage",level:2},{value:"Installation",id:"installation",level:3},{value:"Examples",id:"examples",level:3}];function h(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.img,{src:"https://img.shields.io/npm/v/@spotifly/auth-token",alt:"npm"})," ",(0,n.jsx)(t.img,{src:"https://codecov.io/gh/eegli/spotifly/branch/main/graph/badge.svg?flag=auth-token",alt:"Codecov"})]}),"\n",(0,n.jsx)(t.h2,{id:"motivation",children:"Motivation"}),"\n",(0,n.jsxs)(t.p,{children:["This package provides a simple and lightweight implementation of Spotify's Authorization Code Flow according to the ",(0,n.jsx)(t.a,{href:"https://developer.spotify.com/documentation/general/guides/authorization/code-flow/",children:"Spotify docs"}),". You authenticate with a Spotify application and get back a refresh token that can be used to access Spotify data in long-running applications. If you're not yet familiar with Spotify's authorization process, check out ",(0,n.jsx)(t.a,{href:"/docs/authorization",children:"this quick summary"})," or read ",(0,n.jsx)(t.a,{href:"https://developer.spotify.com/documentation/general/guides/authorization/",children:"the official docs"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Usually, a refresh token only needs to be generated once. Such a token only expires when the client secret of your Spotify application is reset and otherwise lives forever."}),"\n",(0,n.jsxs)(t.p,{children:["This helper was mainly developed to simplify my ",(0,n.jsx)(t.a,{href:"https://github.com/eegli/spotify-history",children:"Spotify history scrobbler"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"cli-usage",children:"CLI Usage"}),"\n",(0,n.jsx)(t.p,{children:"Create your custom command using the query builder below and paste it into your terminal."}),"\n","\n","\n",(0,n.jsx)(s.q,{cli:"spotifly auth",npx:"npx @spotifly/cli@latest auth",args:{"client-id":"","client-secret":"",port:"3000",scopes:["user-read-email"],"file-name":"spotify-token","out-dir":""},flags:{"no-emit":!1},scopesKey:"scopes",required:["client-id","client-secret"]}),"\n",(0,n.jsx)(t.h3,{id:"flags-and-commands",children:"Flags and Commands"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"Usage: spotifly auth [command?] <...flags>\n\nCommands\n   help   Print this help message\n\nRequired flags\n   --client-id [string]       The client id of your Spotify application\n   --client-secret [string]   The client secret of your Spotify application\n\nOptional flags\n   -f, --file-name [string]   Custom name for the output JSON file\n   --no-emit [boolean]        When set to true, does not save the token to the file system\n   -o, --out-dir [string]     Custom relative output directory\n   -p, --port [number]        Port for the localhost redirect URL\n   -s, --scopes [string]      Spotify authorization scopes. Multiple scopes need to be separated by a space\n   -h, --help                 Print this help message\n"})}),"\n",(0,n.jsx)(t.h2,{id:"programmatic-usage",children:"Programmatic Usage"}),"\n",(0,n.jsx)(t.h3,{id:"installation",children:"Installation"}),"\n",(0,n.jsxs)(l.Z,{groupId:"npm2yarn",children:[(0,n.jsx)(i.Z,{value:"npm",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"npm install -D @spotifly/auth-token\n"})})}),(0,n.jsx)(i.Z,{value:"yarn",label:"Yarn",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"yarn add --dev @spotifly/auth-token\n"})})}),(0,n.jsx)(i.Z,{value:"pnpm",label:"pnpm",children:(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"pnpm add -D @spotifly/auth-token\n"})})})]}),"\n",(0,n.jsx)(t.h3,{id:"examples",children:"Examples"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"ES Modules"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-js",children:"import { authorize } from '@spotifly/auth-token';\n\nconst token = await authorize({\n  clientId: 'clientId',\n  clientSecret: 'clientSecret',\n  port: 3000,\n  scopes: 'user-read-email user-top-read',\n});\n"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"TypeScript"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-ts",children:"import { authorize, Options } from '@spotifly/auth-token';\n\nconst options: Options = {\n  clientId: 's',\n  clientSecret: 's',\n  noEmit: true,\n};\n\nconst token = await authorize(options);\n"})})]})}function m(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},9798:(e,t,a)=>{a.d(t,{Z:()=>i});a(7378);var n=a(624);const r={tabItem:"tabItem_wHwb"};var l=a(4246);function i(e){let{children:t,hidden:a,className:i}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,n.Z)(r.tabItem,i),hidden:a,children:t})}},3930:(e,t,a)=>{a.d(t,{Z:()=>k});var n=a(7378),r=a(624),l=a(3457),i=a(3620),s=a(9834),o=a(654),c=a(784),u=a(1819);function d(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:a,attributes:n,default:r}}=e;return{value:t,label:a,attributes:n,default:r}}))}(a);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function h(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:a}=e;const r=(0,i.k6)(),l=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,o._X)(l),(0,n.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(r.location.search);t.set(l,e),r.replace({...r.location,search:t.toString()})}),[l,r])]}function f(e){const{defaultValue:t,queryString:a=!1,groupId:r}=e,l=p(e),[i,o]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=a.find((e=>e.default))??a[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:l}))),[c,d]=m({queryString:a,groupId:r}),[f,g]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,l]=(0,u.Nk)(a);return[r,(0,n.useCallback)((e=>{a&&l.set(e)}),[a,l])]}({groupId:r}),b=(()=>{const e=c??f;return h({value:e,tabValues:l})?e:null})();(0,s.Z)((()=>{b&&o(b)}),[b]);return{selectedValue:i,selectValue:(0,n.useCallback)((e=>{if(!h({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),g(e)}),[d,g,l]),tabValues:l}}var g=a(6457);const b={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var y=a(4246);function x(e){let{className:t,block:a,selectedValue:n,selectValue:i,tabValues:s}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,l.o5)(),u=e=>{const t=e.currentTarget,a=o.indexOf(t),r=s[a].value;r!==n&&(c(t),i(r))},d=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const a=o.indexOf(e.currentTarget)+1;t=o[a]??o[0];break}case"ArrowLeft":{const a=o.indexOf(e.currentTarget)-1;t=o[a]??o[o.length-1];break}}t?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":a},t),children:s.map((e=>{let{value:t,label:a,attributes:l}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>o.push(e),onKeyDown:d,onClick:u,...l,className:(0,r.Z)("tabs__item",b.tabItem,l?.className,{"tabs__item--active":n===t}),children:a??t},t)}))})}function v(e){let{lazy:t,children:a,selectedValue:r}=e;const l=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=l.find((e=>e.props.value===r));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:l.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==r})))})}function j(e){const t=f(e);return(0,y.jsxs)("div",{className:(0,r.Z)("tabs-container",b.tabList),children:[(0,y.jsx)(x,{...e,...t}),(0,y.jsx)(v,{...e,...t})]})}function k(e){const t=(0,g.Z)();return(0,y.jsx)(j,{...e,children:d(e.children)},String(t))}},5705:(e,t,a)=>{a.d(t,{q:()=>v});var n=a(2750),r=a(1758),l=a(4614),i=a(1230),s=a(483),o=a(1015),c=a(4669),u=a(5140),d=a(4591),p=a(7378),h=a(2806),m=a(5731),f=a(2536),g=a(4246);const b=e=>{let{children:t}=e;return(0,g.jsx)(f.Z,{language:"npx",children:t})},y=["token","profile"],x="auth method",v=e=>{let{cli:t,npx:a,args:f,flags:v,required:j=[],scopesKey:k,accessToken:w}=e;const[S,I]=p.useState({...f,...v}),[Z,C]=p.useState("token"),[q,T]=p.useState(""),V=null!=w,N=e=>j.includes(e),E={...S,[Z]:q};return(0,g.jsxs)(h.C,{children:[V?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(r.Z,{component:"form",sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"15px 10px","& > *":{width:"25ch"},mb:2},children:[(0,g.jsx)(d.Z,{sx:{width:"25ch"},variant:"outlined",value:Z,label:x,select:!0,required:!0,onChange:e=>{C(e.target.value),T("")},children:y.map((e=>(0,g.jsx)(c.Z,{value:e,children:e},e)))},x),(0,g.jsx)(d.Z,{type:"text",required:!0,label:Z,value:q,onChange:e=>T(e.target.value),variant:"outlined"},"auth input")]}),(0,g.jsxs)("p",{children:["Using this command requires authentication. If you have Spotifly configuration file, you can specify a profile to use instead of an access token. If you specify a profile, an access token will be used automatically for you. See"," ",(0,g.jsx)("a",{href:"/docs/command-line#configuration-and-auto-authentication",children:"the docs about access configuration"}),"."]}),(0,g.jsx)("hr",{})]}):null,(0,g.jsx)(r.Z,{component:"form",sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:"15px 10px","& > *":{width:"25ch"},mb:2},children:Object.entries(S).map((e=>{let[t,a]=e;return"boolean"==typeof a?(0,g.jsx)(r.Z,{display:"flex",justifyContent:"center",children:(0,g.jsx)(s.Z,{label:t,control:(0,g.jsx)(l.Z,{checked:a,onChange:()=>I({...S,[t]:!a})},t)},t)},t):t===k?(0,g.jsxs)(i.Z,{required:N(t),children:[(0,g.jsx)(o.Z,{htmlFor:t,children:t}),(0,g.jsx)(u.Z,{multiple:!0,labelId:t,label:t,value:a,onChange:e=>I({...S,[t]:e.target.value}),children:m.g8.map((e=>(0,g.jsx)(c.Z,{value:e,children:e},e)))})]},t):Array.isArray(a)?(0,g.jsx)(d.Z,{variant:"outlined",value:a[0],label:t,select:!0,required:N(t),onChange:e=>{I({...S,[t]:(0,m.p1)(a,e.target.value)})},children:a.map((e=>(0,g.jsx)(c.Z,{value:e,children:e},e)))},t):(0,g.jsx)(d.Z,{type:"text",required:N(t),label:t,value:a,onChange:e=>I({...S,[t]:e.target.value}),variant:"outlined"},t)}))}),[["With NPX",a],["With CLI",t]].map((e=>{let[t,a]=e;return(0,g.jsxs)(p.Fragment,{children:[(0,g.jsx)(n.Z,{fontWeight:"bold",children:t}),(0,g.jsx)(b,{children:(0,m._F)({base:a,obj:E,multiValueKeys:[k]})})]},t)}))]})}},2806:(e,t,a)=>{a.d(t,{C:()=>u});var n=a(5421),r=a(2905),l=a(5970),i=a(7378),s=a(4246);const o=(0,r.Z)({palette:{mode:"dark",primary:{main:"#90caf9",light:"#b5dcfb",dark:"#6bb8f7"}}}),c=(0,r.Z)({palette:{mode:"light",primary:{main:"#4a44a2",light:"#514bb2",dark:"#433d92"}}}),u=e=>{let{children:t}=e;const{colorMode:a}=(0,n.I)(),r=(0,i.useMemo)((()=>"light"===a?c:o),[a]);return(0,s.jsx)(l.Z,{theme:r,children:t})}},5731:(e,t,a)=>{function n(e){let{base:t,obj:a,multiValueKeys:n=[]}=e;return t.trim()+" "+Object.entries(a).reduce(((e,t)=>{let[a,r]=t;if(!1===r||""===r)return e;if(e+=`--${a} `,!0===r)return e;if(Array.isArray(r)){return e+=(n.includes(a)?`"${r.join(" ")}"`:r[0])+" "}return r.indexOf(" ")>-1&&" "!==r.slice(-1)&&(r=`"${r}"`),e+r+" "}),"").trim()}function r(e,t){const a=e.indexOf(t);return a>-1&&([e[0],e[a]]=[e[a],e[0]]),e}a.d(t,{_F:()=>n,g8:()=>l,p1:()=>r});const l=["ugc-image-upload","user-read-playback-state","user-modify-playback-state","user-read-currently-playing","user-read-private","user-read-email","user-follow-modify","user-follow-read","user-library-modify","user-library-read","app-remote-control","user-read-playback-position","user-top-read","user-read-recently-played","playlist-modify-private","playlist-read-collaborative","playlist-read-private","playlist-modify-public"]}}]);