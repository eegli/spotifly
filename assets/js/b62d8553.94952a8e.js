"use strict";(self.webpackChunk_spotifly_website=self.webpackChunk_spotifly_website||[]).push([[889],{330:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>c,toc:()=>h});var l=n(4246),r=n(1670),i=n(3930),t=n(9798);const a={title:"Core"},o=void 0,c={id:"packages/core",title:"Core",description:"npm (scoped) Codecov",source:"@site/docs/packages/core.mdx",sourceDirName:"packages",slug:"/packages/core",permalink:"/docs/packages/core",draft:!1,unlisted:!1,editUrl:"https://github.com/eegli/spotifly/tree/main/website/docs/packages/core.mdx",tags:[],version:"current",frontMatter:{title:"Core"},sidebar:"tutorialSidebar",previous:{title:"Auth Token",permalink:"/docs/packages/auth-token"},next:{title:"Library",permalink:"/docs/packages/library/"}},d={},h=[{value:"Motivation",id:"motivation",level:2},{value:"Usage",id:"usage",level:2},{value:"Installation",id:"installation",level:3},{value:"Example",id:"example",level:3},{value:"Authentication",id:"authentication",level:3},{value:"Supported Endpoints and Methods",id:"supported-endpoints-and-methods",level:3},{value:"Response Schema",id:"response-schema",level:3},{value:"Future",id:"future",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Convenience Methods",id:"convenience-methods",level:2},{value:"Usage",id:"usage-1",level:3},{value:"Callbacks",id:"callbacks",level:3},{value:"Helper Types",id:"helper-types",level:2},{value:"Testing Recipes",id:"testing-recipes",level:2}];function u(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components},{Details:n}=s;return n||function(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.img,{src:"https://img.shields.io/npm/v/@spotifly/core",alt:"npm (scoped)"})," ",(0,l.jsx)(s.img,{src:"https://codecov.io/gh/eegli/spotifly/branch/main/graph/badge.svg?flag=core",alt:"Codecov"})]}),"\n",(0,l.jsx)(s.h2,{id:"motivation",children:"Motivation"}),"\n",(0,l.jsxs)(s.p,{children:["The Spotifly core library is a lightweight wrapper for the ",(0,l.jsx)(s.a,{href:"https://developer.spotify.com/documentation/web-api/",children:"Spotify Web API"}),". Why would you use it?"]}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Strong TypeScript and IntelliSense support"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"All function parameters and return values are strongly typed"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"A neatly organized, intuitive API"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Sticks closely to the semantics of the Web API"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Convenience methods for limited and paginated endpoints"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Automatically retreive all items from paginated and limited endpoints"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Automatic authentication"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Provide your credentials once and have every request authenticate automatically with Spotify"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"100% future-proof"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Today's wrapper API supports the Spotify endpoints of tomorrow"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Testing with confidence"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Creating stubs for the core lib is a piece of cake. Read along for testing recipes!"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.p,{children:"Although the core library is very lightweight, it may be overkill if you're only interested in one or two Web API endpoints. However, for many other use cases, including long-running apps, it's a great fit."}),"\n",(0,l.jsx)(s.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(s.h3,{id:"installation",children:"Installation"}),"\n",(0,l.jsx)(s.p,{children:"Node.js \u2265 18 is required. Installing the types for the Web API is highly recommended!"}),"\n",(0,l.jsxs)(i.Z,{groupId:"npm2yarn",children:[(0,l.jsx)(t.Z,{value:"npm",children:(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"npm install @spotifly/core @types/spotify-api\n"})})}),(0,l.jsx)(t.Z,{value:"yarn",label:"Yarn",children:(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"yarn add @spotifly/core @types/spotify-api\n"})})}),(0,l.jsx)(t.Z,{value:"pnpm",label:"pnpm",children:(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"pnpm add @spotifly/core @types/spotify-api\n"})})})]}),"\n",(0,l.jsx)(s.h3,{id:"example",children:"Example"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly from '@spotifly/core';\n\nconst spotifyClient = Spotifly.initialize({\n  accessToken: 'abc123',\n});\n\n// Deriving the genres of a track via its artists\nawait spotifyClient.Tracks.getTrack('5nHc8CmiPllMzHbJhhx3KS')\n  .then(res => {\n    return res.data.artists.map(artist => artist.id);\n  })\n  .then(artistIds => {\n    return spotifyClient.Artists.getSeveralArtists(artistIds);\n  })\n  .then(res => {\n    const genres = res.data.artists.map(artist => artist.genres).flat();\n    console.log(genres); // [ 'livetronica', 'munich electronic' ]\n  });\n\n// Getting all of a user's saved tracks\nawait spotifyClient.Tracks.getAllUsersSavedTracks()()\n  .then(res => {\n    return res.map(res => res.data.items).flat();\n  })\n  .then(library => {\n    console.log(library.length); // 70\n  });\n\n// Searching for an item\nawait spotifyClient.Search.search({ query: 'eminem', type: 'album' }).then(\n  res => {\n    console.log(res.data.albums?.items[0]?.name); // 'The Eminem Show'\n  },\n);\n"})}),"\n",(0,l.jsx)(s.h3,{id:"authentication",children:"Authentication"}),"\n",(0,l.jsxs)(s.p,{children:["Every Spotify client is created through a call to ",(0,l.jsx)(s.code,{children:"initialize"}),". A client is bound to the ",(0,l.jsx)(s.strong,{children:"authentication method it was instantiated with"}),". There are multiple ways to instantiate a client:"]}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"With a Spotify client id, client secret and refresh token"})," - This method will automatically generate an initial access token and refresh it when it's about to expire after 1 hour. This is great for apps that need to run independently."]}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly from '@spotifly/core';\n\nconst spotifyClient = Spotifly.initialize({\n  clientId: process.env.SPOTIFY_CLIENT_ID || '',\n  clientSecret: process.env.SPOTIFY_CLIENT_SECRET || '',\n  refreshToken: process.env.SPOTIFY_REFRESH_TOKEN || '',\n});\n"})}),"\n",(0,l.jsxs)(s.ol,{start:"2",children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"With a Spotify access token"})," - This method will simply attach the provided access token to requests to Spotify. No secrets are involved but requests may fail once the token has expired."]}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly from '@spotifly/core';\n\nconst spotifyClient = Spotifly.initialize({\n  accessToken: 'abc123',\n});\n"})}),"\n",(0,l.jsx)(s.p,{children:"Both methods return a Spotify client with the same methods."}),"\n",(0,l.jsx)(s.admonition,{type:"tip",children:(0,l.jsxs)(s.p,{children:["Usually, a refresh token only needs to be generated once. You can ",(0,l.jsx)(s.a,{href:"/docs/authorization",children:"generate one here"})," using the Authorization Code Flow."]})}),"\n",(0,l.jsx)(s.h3,{id:"supported-endpoints-and-methods",children:"Supported Endpoints and Methods"}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.a,{href:"https://developer.spotify.com/documentation/web-api/reference/#/",children:"Web API Reference"}),"."]}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"\u2705 - Fully supported"}),"\n",(0,l.jsx)(s.li,{children:"\u303d\ufe0f - Partial support - work in progress"}),"\n",(0,l.jsx)(s.li,{children:"\u274c - Currently not supported"}),"\n"]}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Endpoint"}),(0,l.jsx)(s.th,{children:"Support"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Albums"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Audiobooks"}),(0,l.jsx)(s.td,{children:"\u274c"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Artists"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Categories"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Chapters"}),(0,l.jsx)(s.td,{children:"\u274c"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Episodes"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Genres"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Markets"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Player"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Playlists"}),(0,l.jsx)(s.td,{children:"\u303d\ufe0f"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Search"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Shows"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Tracks"}),(0,l.jsx)(s.td,{children:"\u2705"})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"Users"}),(0,l.jsx)(s.td,{children:"\u2705"})]})]})]}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Playlists, missing: ",(0,l.jsx)(s.a,{href:"https://developer.spotify.com/documentation/web-api/reference/#/operations/reorder-or-replace-playlists-tracks",children:"Replace Playlist Items"}),'. I don\'t understand how this endpoint needs to be called in order to "replace" playlist items. Reordering items, however, is supported.']}),"\n",(0,l.jsx)(s.li,{children:"Audiobooks and Chapters: Not yet available in many regions."}),"\n"]}),"\n",(0,l.jsxs)(n,{children:[(0,l.jsx)("summary",{children:"Detailed Support Table"}),(0,l.jsxs)("ul",{children:[(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Albums"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Albums.checkAllUsersSavedAlbums"}),(0,l.jsx)("li",{children:"Albums.checkUsersSavedAlbums"}),(0,l.jsx)("li",{children:"Albums.getAlbum"}),(0,l.jsx)("li",{children:"Albums.getAlbumTracks"}),(0,l.jsx)("li",{children:"Albums.getAllAlbumTracks"}),(0,l.jsx)("li",{children:"Albums.getAllAlbums"}),(0,l.jsx)("li",{children:"Albums.getAllUsersSavedAlbums"}),(0,l.jsx)("li",{children:"Albums.getNewAlbumReleases"}),(0,l.jsx)("li",{children:"Albums.getSeveralAlbums"}),(0,l.jsx)("li",{children:"Albums.getUsersSavedAlbums"}),(0,l.jsx)("li",{children:"Albums.removeAllUsersSavedAlbums"}),(0,l.jsx)("li",{children:"Albums.removeUsersSavedAlbums"}),(0,l.jsx)("li",{children:"Albums.saveAlbumsForUser"}),(0,l.jsx)("li",{children:"Albums.saveAllAlbumsForUser"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Artists"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Artists.getAllArtists"}),(0,l.jsx)("li",{children:"Artists.getAllArtistsAlbums"}),(0,l.jsx)("li",{children:"Artists.getArtist"}),(0,l.jsx)("li",{children:"Artists.getArtistsAlbums"}),(0,l.jsx)("li",{children:"Artists.getArtistsRelatedArtists"}),(0,l.jsx)("li",{children:"Artists.getArtistsTopTracks"}),(0,l.jsx)("li",{children:"Artists.getSeveralArtists"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Categories"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Categories.getCategory"}),(0,l.jsx)("li",{children:"Categories.getSeveralCategories"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Episodes"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Episodes.beta.checkAllUsersSavedEpisodes"}),(0,l.jsx)("li",{children:"Episodes.beta.checkUsersSavedEpisodes"}),(0,l.jsx)("li",{children:"Episodes.beta.getAllUsersSavedEpisodes"}),(0,l.jsx)("li",{children:"Episodes.beta.getUsersSavedEpisodes"}),(0,l.jsx)("li",{children:"Episodes.beta.removeAllUsersSavedEpisodes"}),(0,l.jsx)("li",{children:"Episodes.beta.removeUsersSavedEpisodes"}),(0,l.jsx)("li",{children:"Episodes.beta.saveAllEpisodesForUser"}),(0,l.jsx)("li",{children:"Episodes.beta.saveEpisodesForUser"}),(0,l.jsx)("li",{children:"Episodes.getAllEpisodes"}),(0,l.jsx)("li",{children:"Episodes.getEpisode"}),(0,l.jsx)("li",{children:"Episodes.getSeveralEpisodes"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Genres"}),(0,l.jsx)("ul",{children:(0,l.jsx)("li",{children:"Genres.getAvailableGenreSeeds"})})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Markets"}),(0,l.jsx)("ul",{children:(0,l.jsx)("li",{children:"Markets.getAvailableMarkets"})})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Player"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Player.addToQueue"}),(0,l.jsx)("li",{children:"Player.getAvailableDevices"}),(0,l.jsx)("li",{children:"Player.getCurrentlyPlayingTrack"}),(0,l.jsx)("li",{children:"Player.getPlaybackState"}),(0,l.jsx)("li",{children:"Player.getRecentlyPlayedTracks"}),(0,l.jsx)("li",{children:"Player.getUsersQueue"}),(0,l.jsx)("li",{children:"Player.pausePlayback"}),(0,l.jsx)("li",{children:"Player.seekToPosition"}),(0,l.jsx)("li",{children:"Player.setPlaybackVolume"}),(0,l.jsx)("li",{children:"Player.setRepeatMode"}),(0,l.jsx)("li",{children:"Player.skipToNext"}),(0,l.jsx)("li",{children:"Player.skipToPrevious"}),(0,l.jsx)("li",{children:"Player.startOrResumePlayback"}),(0,l.jsx)("li",{children:"Player.togglePlaybackShuffle"}),(0,l.jsx)("li",{children:"Player.transferPlayback"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Playlists"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Playlists.addPlaylistItems"}),(0,l.jsx)("li",{children:"Playlists.changePlaylist"}),(0,l.jsx)("li",{children:"Playlists.createPlaylist"}),(0,l.jsx)("li",{children:"Playlists.getAllCurrentUsersPlaylists"}),(0,l.jsx)("li",{children:"Playlists.getAllPlaylistItems"}),(0,l.jsx)("li",{children:"Playlists.getAllUsersPlaylists"}),(0,l.jsx)("li",{children:"Playlists.getCategoryPlaylists"}),(0,l.jsx)("li",{children:"Playlists.getCurrentUsersPlaylists"}),(0,l.jsx)("li",{children:"Playlists.getFeaturedPlaylists"}),(0,l.jsx)("li",{children:"Playlists.getPlaylist"}),(0,l.jsx)("li",{children:"Playlists.getPlaylistCoverImage"}),(0,l.jsx)("li",{children:"Playlists.getPlaylistItems"}),(0,l.jsx)("li",{children:"Playlists.getUsersPlaylists"}),(0,l.jsx)("li",{children:"Playlists.removePlaylistItems"}),(0,l.jsx)("li",{children:"Playlists.reorderPlaylistItems"}),(0,l.jsx)("li",{children:"Playlists.uploadCustomPlaylistCoverImage"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Search"}),(0,l.jsx)("ul",{children:(0,l.jsx)("li",{children:"Search.search"})})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Shows"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Shows.checkAllUsersSavedShows"}),(0,l.jsx)("li",{children:"Shows.checkUsersSavedShows"}),(0,l.jsx)("li",{children:"Shows.getAllShowEpisodes"}),(0,l.jsx)("li",{children:"Shows.getAllShows"}),(0,l.jsx)("li",{children:"Shows.getAllUsersSavedShows"}),(0,l.jsx)("li",{children:"Shows.getSeveralShows"}),(0,l.jsx)("li",{children:"Shows.getShow"}),(0,l.jsx)("li",{children:"Shows.getShowEpisodes"}),(0,l.jsx)("li",{children:"Shows.getUsersSavedShows"}),(0,l.jsx)("li",{children:"Shows.removeAllUsersSavedShows"}),(0,l.jsx)("li",{children:"Shows.removeUsersSavedShows"}),(0,l.jsx)("li",{children:"Shows.saveAllShowsForUser"}),(0,l.jsx)("li",{children:"Shows.saveShowsForUser"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Tracks"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Tracks.checkAllUsersSavedTracks"}),(0,l.jsx)("li",{children:"Tracks.checkUsersSavedTracks"}),(0,l.jsx)("li",{children:"Tracks.getAllAudioFeatures"}),(0,l.jsx)("li",{children:"Tracks.getAllTracks"}),(0,l.jsx)("li",{children:"Tracks.getAllUsersSavedTracks"}),(0,l.jsx)("li",{children:"Tracks.getAudioAnalysis"}),(0,l.jsx)("li",{children:"Tracks.getAudioFeatures"}),(0,l.jsx)("li",{children:"Tracks.getRecommendations"}),(0,l.jsx)("li",{children:"Tracks.getSeveralAudioFeatures"}),(0,l.jsx)("li",{children:"Tracks.getSeveralTracks"}),(0,l.jsx)("li",{children:"Tracks.getTrack"}),(0,l.jsx)("li",{children:"Tracks.getUsersSavedTracks"}),(0,l.jsx)("li",{children:"Tracks.removeAllUsersTracksForUser"}),(0,l.jsx)("li",{children:"Tracks.removeUsersSavedTracks"}),(0,l.jsx)("li",{children:"Tracks.saveAllTracksForUser"}),(0,l.jsx)("li",{children:"Tracks.saveTracksForUser"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"Users"}),(0,l.jsxs)("ul",{children:[(0,l.jsx)("li",{children:"Users.checkFollowsAllArtists"}),(0,l.jsx)("li",{children:"Users.checkFollowsAllUsers"}),(0,l.jsx)("li",{children:"Users.checkFollowsArtists"}),(0,l.jsx)("li",{children:"Users.checkFollowsUsers"}),(0,l.jsx)("li",{children:"Users.checkUsersFollowPlaylist"}),(0,l.jsx)("li",{children:"Users.followAllArtists"}),(0,l.jsx)("li",{children:"Users.followAllUsers"}),(0,l.jsx)("li",{children:"Users.followArtists"}),(0,l.jsx)("li",{children:"Users.followPlaylist"}),(0,l.jsx)("li",{children:"Users.followUsers"}),(0,l.jsx)("li",{children:"Users.getAllUsersTopArtists"}),(0,l.jsx)("li",{children:"Users.getAllUsersTopTracks"}),(0,l.jsx)("li",{children:"Users.getCurrentUsersProfile"}),(0,l.jsx)("li",{children:"Users.getUsersFollowedArtists"}),(0,l.jsx)("li",{children:"Users.getUsersProfile"}),(0,l.jsx)("li",{children:"Users.getUsersTopArtists"}),(0,l.jsx)("li",{children:"Users.getUsersTopTracks"}),(0,l.jsx)("li",{children:"Users.unfollowAllArtists"}),(0,l.jsx)("li",{children:"Users.unfollowAllUsers"}),(0,l.jsx)("li",{children:"Users.unfollowArtists"}),(0,l.jsx)("li",{children:"Users.unfollowPlaylist"}),(0,l.jsx)("li",{children:"Users.unfollowUsers"})]})]}),(0,l.jsxs)("li",{children:[(0,l.jsx)("b",{children:"future"}),(0,l.jsx)("ul",{children:(0,l.jsx)("li",{children:"future.request"})})]})]})]}),"\n",(0,l.jsx)(s.h3,{id:"response-schema",children:"Response Schema"}),"\n",(0,l.jsxs)(s.p,{children:["The core library uses ",(0,l.jsx)(s.a,{href:"https://axios-http.com/",children:(0,l.jsx)(s.code,{children:"axios"})})," for all HTTP requests to Spotify. Each method call returns a ",(0,l.jsx)(s.code,{children:"DataResponse"})," object with request metadata. Convenience methods will return a ",(0,l.jsx)(s.code,{children:"DataResponse"})," array. ",(0,l.jsx)(s.code,{children:"data"})," will hold the return value of interest."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"type DataResponse<Data = unknown> = {\n  data: Data;\n  statusCode: number;\n} & Pick<AxiosResponse, 'headers'>;\n"})}),"\n",(0,l.jsxs)(s.p,{children:["Both ",(0,l.jsx)(s.code,{children:"DataResponse"})," and ",(0,l.jsx)(s.code,{children:"DataPromise"})," are exported so you don't have to infer them. The latter simply wraps the former in a ",(0,l.jsx)(s.code,{children:"Promise"}),"."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import type { DataResponse, DataPromise } from '@spotifly/core';\n"})}),"\n",(0,l.jsx)(s.h3,{id:"future",children:"Future"}),"\n",(0,l.jsxs)(s.p,{children:["Today's client supports the Spotify endpoints of tomorrow. The API features a ",(0,l.jsx)(s.code,{children:"future.request"})," function that acts as an escape hatch for everything that is not yet or incorretly supported by this library. Requests made through ",(0,l.jsx)(s.code,{children:"future.request"})," always include the Authorization header."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly from '@spotifly/core';\n\nconst spotifyClient = Spotifly.initialize({\n  accessToken: 'abc123',\n});\n\nawait spotifyClient.future\n  .request<MyResponseType>({ url: 'me/new-releases' })\n  .then(console.log); // typeof MyResponseType\n"})}),"\n",(0,l.jsx)(s.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(s.p,{children:"The regular error object as defined by the Web API has the following shape:"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"type SpotifyRegularErrorObject = {\n  status: number;\n  message: string;\n};\n"})}),"\n",(0,l.jsxs)(s.p,{children:["You can use the ",(0,l.jsx)(s.code,{children:"isError"})," helper to safely access the error object in case something goes wrong."]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly from '@spotifly/core';\n\nconst spotifyClient = Spotifly.initialize({\n  accessToken: 'abc123',\n});\n\ntry {\n  await spotifyClient.Tracks.getTrack('thistrackdoesnotexist');\n} catch (e) {\n  if (Spotifly.isError(e)) {\n    console.log(e.response?.data.error.status); // 404\n    console.log(e.response?.data.error.message); // 'Not Found'\n  }\n}\n"})}),"\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.a,{href:"https://developer.spotify.com/documentation/web-api/",children:"See Web API / Response Schema"}),"."]}),"\n",(0,l.jsx)(s.h2,{id:"convenience-methods",children:"Convenience Methods"}),"\n",(0,l.jsxs)(s.p,{children:["Methods that contain ",(0,l.jsx)(s.code,{children:"all"})," in their name are convenience methods for (offset-based) paginated and limited endpoints. Limited endpoints expect a maximum amount of items when queried."]}),"\n",(0,l.jsxs)(s.p,{children:["Examples are ",(0,l.jsx)(s.code,{children:"Tracks.getAllUsersSavedTracks"})," (paginated) and ",(0,l.jsx)(s.code,{children:"Tracks.getAllTracks"})," (limited). The Spotify Web API returns at most 50 items when asked for a user's saved tracks and allows no more than 50 track ids when querying for track catalog information."]}),"\n",(0,l.jsxs)(s.p,{children:["You can equivalently call the corresponding non-convenience methods ",(0,l.jsx)(s.code,{children:"Tracks.getUsersSavedTracks"})," and ",(0,l.jsx)(s.code,{children:"Tracks.getSeveralTracks"})," with the same arguments. However, you would have to manually handle pagination and chunking of ids. Convenience methods take care of this for you."]}),"\n",(0,l.jsx)(s.h3,{id:"usage-1",children:"Usage"}),"\n",(0,l.jsx)(s.p,{children:"All convenience methods are aware of their specific limitations. They know how many items they can request from Spotify at once and will max out each request, taking care of chunking item ids and handling paginated endpoints."}),"\n",(0,l.jsx)(s.p,{children:"Non-convenience/ordinary methods do not have such logic. They do not check or chunk requests and it's up to you to make sure you're calling the endpoint according to its usage."}),"\n",(0,l.jsx)(s.h3,{id:"callbacks",children:"Callbacks"}),"\n",(0,l.jsxs)(s.p,{children:["The following example returns all of a user's saved tracks in a flat array. Convenience methods have a different signature: ",(0,l.jsx)(s.strong,{children:"They are curried and return a function which optionally accepts a callback"}),". Each time a new chunk of items is fetched, the response wrapped in a ",(0,l.jsx)(s.code,{children:"DataResponse<T>"})," is passed to the callback as the only argument. See the ",(0,l.jsx)(s.a,{href:"#helper-types",children:"helper types"})," section below for more."]}),"\n",(0,l.jsx)(s.p,{children:"If the callback returns a promise, it is awaited. The eventually returned value is ignored."}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly, { DataResponse } from '@spotifly/core';\n\nconst spotifyClient = Spotifly.initialize({\n  accessToken: 'abc123',\n});\n\nconst allTracks = await spotifyClient.Tracks.getAllUsersSavedTracks()(\n  async response => {\n    // DataResponse<SpotifyApi.UsersSavedTracksResponse>\n    console.log(`fetched ${response.data.items.length} items!`);\n  },\n).then(allResponses => {\n  return allResponses.map(({ data }) => data.items).flat();\n});\n"})}),"\n",(0,l.jsx)(s.p,{children:"You can do pretty much anything with the chunk - e.g., log something to the console or send the items somewhere else."}),"\n",(0,l.jsxs)(s.p,{children:["Convenience methods simply wrap their ordinary counterpart and resolve all responses in a single array. This is reflected in their return types: If the ordinary methods returns ",(0,l.jsx)(s.code,{children:"DataResponse<T>"}),", the convenience method returns ",(0,l.jsx)(s.code,{children:"Array<DataResponse<T>>"}),":"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly, { DataResponse } from '@spotifly/core';\n\nconst spotifyClient = Spotifly.initialize({\n  accessToken: 'abc123',\n});\n\ntype UserTracks = DataResponse<SpotifyApi.UsersSavedTracksResponse>;\n\nconst allTracks: UserTracks[] =\n  await spotifyClient.Tracks.getAllUsersSavedTracks()();\n\nconst someTracks: UserTracks = await spotifyClient.Tracks.getUsersSavedTracks();\n"})}),"\n",(0,l.jsxs)(s.p,{children:["If you want to define your callback function separately, there's a helper type which can infer the correct signature (",(0,l.jsx)(s.code,{children:"DataCallback"}),")."]}),"\n",(0,l.jsx)(s.h2,{id:"helper-types",children:"Helper Types"}),"\n",(0,l.jsxs)(s.p,{children:["The ",(0,l.jsx)(s.code,{children:"SpotifyClient"})," type mirrors the structure of an ",(0,l.jsx)(s.em,{children:"initialized"})," client. ",(0,l.jsx)(s.code,{children:"DataCallback"})," can be used to infer the signature of the callback to a curried function (convenience method). Both types can be useful in some scenarios:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import { DataCallback, initialize, SpotifyClient } from '@spotifly/core';\n\ntype Callback = DataCallback<SpotifyClient['Tracks']['getAllUsersSavedTracks']>;\n\nconst callback: Callback = response => {\n  console.log(response.data.items[0].added_at);\n};\n\nconst spotifyClient = initialize({\n  accessToken: 'abc123',\n});\n\n// Signature is correct!\nawait spotifyClient.Tracks.getAllUsersSavedTracks()(callback);\n"})}),"\n",(0,l.jsx)(s.h2,{id:"testing-recipes",children:"Testing Recipes"}),"\n",(0,l.jsxs)(s.p,{children:["The core library can be mocked nicely with ",(0,l.jsx)(s.a,{href:"https://jestjs.io/",children:(0,l.jsx)(s.code,{children:"Jest"})})," and the TypeScript-friendly ",(0,l.jsx)(s.a,{href:"https://www.npmjs.com/package/jest-mock-extended",children:(0,l.jsx)(s.code,{children:"jest-mock-extended"})})," extension. The following examples assume you have already installed ",(0,l.jsx)(s.code,{children:"@types/spotify-api"})," and setup ",(0,l.jsx)(s.code,{children:"Jest"})," accordingly for your project."]}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["Install ",(0,l.jsx)(s.code,{children:"jest-mock-extended"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(i.Z,{groupId:"npm2yarn",children:[(0,l.jsx)(t.Z,{value:"npm",children:(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"npm install -D jest-mock-extended\n"})})}),(0,l.jsx)(t.Z,{value:"yarn",label:"Yarn",children:(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"yarn add --dev jest-mock-extended\n"})})}),(0,l.jsx)(t.Z,{value:"pnpm",label:"pnpm",children:(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"pnpm add -D jest-mock-extended\n"})})})]}),"\n",(0,l.jsxs)(s.ol,{start:"2",children:["\n",(0,l.jsxs)(s.li,{children:["Mock whatever methods you are using using the ",(0,l.jsx)(s.code,{children:"mockDeep"})," helper and inject this object whenever ",(0,l.jsx)(s.code,{children:"initialize"})," is called in the implementation. Using the types from ",(0,l.jsx)(s.code,{children:"@types/spotify-api"}),", it's very easy to create solid mock responses."]}),"\n"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-ts",children:"import Spotifly, { DataResponse, SpotifyClient } from '@spotifly/core';\nimport { mockDeep } from 'jest-mock-extended';\n\nconst audioFeatures: SpotifyApi.AudioFeaturesObject = {\n  acousticness: 0.00242,\n  analysis_url: 'https://api.spotify.com/v1/audio-analysis/2takc7B',\n  danceability: 0.585,\n  duration_ms: 237040,\n  energy: 0.842,\n  id: '2takc7B',\n  instrumentalness: 0.00686,\n  key: 9,\n  liveness: 0.0866,\n  loudness: -5.883,\n  mode: 0,\n  speechiness: 0.0556,\n  tempo: 118.211,\n  time_signature: 4,\n  track_href: 'https://api.spotify.com/v1/tracks/2takc7B',\n  type: 'audio_features',\n  uri: 'spotify:track:2takc7B',\n  valence: 0.428,\n};\n\ntype MockResponse = DataResponse<SpotifyApi.MultipleAudioFeaturesResponse>;\n\nconst mockResponse = (length: number): MockResponse => {\n  return {\n    data: {\n      audio_features: Array.from({ length }, () => audioFeatures),\n    },\n    statusCode: 200,\n    headers: {},\n  };\n};\n\nconst mockSpotify = mockDeep<SpotifyClient>();\n\n// Return a mocked client whenever the client is initialized\njest.spyOn(Spotifly, 'initialize').mockReturnValue(mockSpotify);\n\n// Mocking an ordinary method\nmockSpotify.Tracks.getSeveralAudioFeatures.mockImplementation(ids => {\n  return Promise.resolve(mockResponse(ids.length));\n});\n\n// Mocking a convenience method\nmockSpotify.Tracks.getAllAudioFeatures.mockImplementation(ids => {\n  return cb => {\n    if (cb) cb(mockResponse(ids.length));\n    return Promise.resolve([mockResponse(ids.length)]);\n  };\n});\n\ntest('my function', async () => {\n  // Your code\n  function getData() {\n    const client = Spotifly.initialize({ accessToken: 'abc123' });\n    return client.Tracks.getSeveralAudioFeatures(['2takc7B', '6hsak']);\n  }\n  // Assert anything!\n  const res = await getData();\n  expect(res.data.audio_features).toHaveLength(2);\n});\n"})})]})}function p(e={}){const{wrapper:s}={...(0,r.a)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},9798:(e,s,n)=>{n.d(s,{Z:()=>t});n(7378);var l=n(624);const r={tabItem:"tabItem_wHwb"};var i=n(4246);function t(e){let{children:s,hidden:n,className:t}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,l.Z)(r.tabItem,t),hidden:n,children:s})}},3930:(e,s,n)=>{n.d(s,{Z:()=>v});var l=n(7378),r=n(624),i=n(3457),t=n(3620),a=n(9834),o=n(654),c=n(784),d=n(1819);function h(e){return l.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,l.isValidElement)(e)&&function(e){const{props:s}=e;return!!s&&"object"==typeof s&&"value"in s}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:s,children:n}=e;return(0,l.useMemo)((()=>{const e=s??function(e){return h(e).map((e=>{let{props:{value:s,label:n,attributes:l,default:r}}=e;return{value:s,label:n,attributes:l,default:r}}))}(n);return function(e){const s=(0,c.l)(e,((e,s)=>e.value===s.value));if(s.length>0)throw new Error(`Docusaurus error: Duplicate values "${s.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[s,n])}function p(e){let{value:s,tabValues:n}=e;return n.some((e=>e.value===s))}function x(e){let{queryString:s=!1,groupId:n}=e;const r=(0,t.k6)(),i=function(e){let{queryString:s=!1,groupId:n}=e;if("string"==typeof s)return s;if(!1===s)return null;if(!0===s&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:s,groupId:n});return[(0,o._X)(i),(0,l.useCallback)((e=>{if(!i)return;const s=new URLSearchParams(r.location.search);s.set(i,e),r.replace({...r.location,search:s.toString()})}),[i,r])]}function j(e){const{defaultValue:s,queryString:n=!1,groupId:r}=e,i=u(e),[t,o]=(0,l.useState)((()=>function(e){let{defaultValue:s,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(s){if(!p({value:s,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${s}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return s}const l=n.find((e=>e.default))??n[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:s,tabValues:i}))),[c,h]=x({queryString:n,groupId:r}),[j,m]=function(e){let{groupId:s}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(s),[r,i]=(0,d.Nk)(n);return[r,(0,l.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:r}),y=(()=>{const e=c??j;return p({value:e,tabValues:i})?e:null})();(0,a.Z)((()=>{y&&o(y)}),[y]);return{selectedValue:t,selectValue:(0,l.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),h(e),m(e)}),[h,m,i]),tabValues:i}}var m=n(6457);const y={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var g=n(4246);function f(e){let{className:s,block:n,selectedValue:l,selectValue:t,tabValues:a}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.o5)(),d=e=>{const s=e.currentTarget,n=o.indexOf(s),r=a[n].value;r!==l&&(c(s),t(r))},h=e=>{let s=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=o.indexOf(e.currentTarget)+1;s=o[n]??o[0];break}case"ArrowLeft":{const n=o.indexOf(e.currentTarget)-1;s=o[n]??o[o.length-1];break}}s?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},s),children:a.map((e=>{let{value:s,label:n,attributes:i}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:l===s?0:-1,"aria-selected":l===s,ref:e=>o.push(e),onKeyDown:h,onClick:d,...i,className:(0,r.Z)("tabs__item",y.tabItem,i?.className,{"tabs__item--active":l===s}),children:n??s},s)}))})}function b(e){let{lazy:s,children:n,selectedValue:r}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(s){const e=i.find((e=>e.props.value===r));return e?(0,l.cloneElement)(e,{className:"margin-top--md"}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:i.map(((e,s)=>(0,l.cloneElement)(e,{key:s,hidden:e.props.value!==r})))})}function k(e){const s=j(e);return(0,g.jsxs)("div",{className:(0,r.Z)("tabs-container",y.tabList),children:[(0,g.jsx)(f,{...e,...s}),(0,g.jsx)(b,{...e,...s})]})}function v(e){const s=(0,m.Z)();return(0,g.jsx)(k,{...e,children:h(e.children)},String(s))}},1670:(e,s,n)=>{n.d(s,{Z:()=>a,a:()=>t});var l=n(7378);const r={},i=l.createContext(r);function t(e){const s=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),l.createElement(i.Provider,{value:s},e.children)}}}]);